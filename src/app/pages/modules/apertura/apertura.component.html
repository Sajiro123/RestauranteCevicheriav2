<p-toast styleClass="text-2xl" />

<div class="card">
    <div class="grid grid-cols-1 sm:grid-cols-2 container">
        <div class="w-full" [formGroup]="cajaForm">
            <div class="left">
                <h1> CAJA</h1>

                <img src="https://cdn-icons-png.flaticon.com/512/3064/3064197.png" alt="Cerrado" />
                <div class="cerrado" *ngIf="data_apertura.length == 0">CERRADO</div>
                <div class="cerrado" *ngIf="data_apertura.length > 0 && cajaForm.get('estado')?.value == 1">ABIERTO
                </div>
                <div class="cerrado" *ngIf="cajaForm.get('estado')?.value == 2">CAJA CERRADA YA EXISTE</div>

                <br />

                <span style="font-weight: bold;">({{ fecha_actual }})</span>

                <p *ngIf="data_apertura.length == 0">
                    Ingrese los datos,<br />
                    para abrir una caja
                </p>
            </div>

            <div class="right">
                <div class="form-group">
                    <label for="caja">Caja</label>
                    <select formControlName="caja" id="caja">
                        <option value="">Seleccionar</option>
                        <option value="1">Caja 1</option>
                    </select>
                    <div *ngIf="cajaForm.get('caja')?.touched && cajaForm.get('caja')?.invalid" class="error">
                        <small *ngIf="cajaForm.get('caja')?.errors?.['required']">La caja es obligatoria</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="turno">Turno</label>
                    <select formControlName="turno" id="turno">
                        <option value="">Seleccionar</option>
                        <option value="Mañana">Mañana</option>
                        <option value="Noche">Noche</option>
                    </select>
                    <div *ngIf="cajaForm.get('turno')?.touched && cajaForm.get('turno')?.invalid" class="error">
                        <small *ngIf="cajaForm.get('turno')?.errors?.['required']">El turno es obligatorio</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="responsable">Responsable</label>
                    <select formControlName="responsable" id="responsable">
                        <option value="">Seleccionar</option>
                        <option value="Sully">Sully</option>
                        <option value="Yordy">Yordy</option>
                        <option value="Alex">Alex</option>
                    </select>
                    <div *ngIf="cajaForm.get('responsable')?.touched && cajaForm.get('responsable')?.invalid"
                        class="error">
                        <small *ngIf="cajaForm.get('responsable')?.errors?.['required']">El responsable es
                            obligatorio</small>
                    </div>
                </div>

                <div class="form-group">
                    <label>Ingrese monto de apertura</label>
                    <div class="money-input">
                        <span>S/</span>
                        <input formControlName="monto" type="number" placeholder="0.00" />
                        <span>Soles</span>
                    </div>
                    <div *ngIf="cajaForm.get('monto')?.touched && cajaForm.get('monto')?.invalid" class="error">
                        <small *ngIf="cajaForm.get('monto')?.errors?.['required']">El monto es obligatorio</small>
                        <small *ngIf="cajaForm.get('monto')?.errors?.['min']">El monto debe ser mayor o igual a
                            0</small>
                    </div>
                </div>

                <button class="btn" type="submit" [disabled]="cajaForm.invalid || cajaForm.pristine"
                    [ngClass]="{ 'btn-danger': estado_caja == 2, 'btn-info': this.estado_caja == 1}"
                    (click)="GuardarCaja(data_apertura.length)">{{ texto_estado_caja
                    }}</button>
            </div>
        </div>
        <div class="w-full gastos" [formGroup]="GastosForm">
            <main class="card main" role="main" aria-label="Formulario de ingreso de gastos de comida">
                <h1> Gastos</h1>
                <p class="subtitle">Ingrese los detalles del gasto para el sistema de comida.</p>
                <div>
                    <label for="expenseName">Descripción del gasto</label>
                    <input formControlName="descripcion" type="text" id="expenseName" name="expenseName"
                        placeholder="Ejemplo: Compra de verduras" required aria-required="true" />
                </div>
                <div>
                    <label for="amount">Monto (PEN)</label>
                    <input formControlName="monto" type="number" id="amount" name="amount" placeholder="Ejemplo: 15.50"
                        step="0.01" min="0" required aria-required="true" />
                </div>
                <div>
                    <label for="date">Fecha</label>
                    <input formControlName="fecha" type="date" id="date" name="date" required aria-required="true" />
                </div>
                <div>
                    <label for="category">Categoría</label>
                    <select formControlName="categoria" id="category" name="category" required aria-required="true">
                        <option value="" disabled selected>Seleccione una categoría</option>
                        <option value="{{list.idcategoriagastos}}" *ngFor="let list of CategoriaGastosList">
                            {{ list.descripcion }}
                        </option>

                    </select>
                </div>
                <div>
                    <label for="notes">Notas (opcional)</label>
                    <textarea formControlName="notas" rows="3" cols="20" fluid pTextarea id="notes" name="notes"
                        placeholder="Comentarios adicionales..."></textarea>
                </div>


                <button style="margin-top: 47px;" pButton type="submit"
                    [disabled]="GastosForm.invalid || GastosForm.pristine" class="btn" (click)="GuardarGastos()">
                    Registrar Gasto
                </button>
            </main>
        </div>
    </div>

</div>
<p-confirmDialog [style]="{ width: '450px' }" />
